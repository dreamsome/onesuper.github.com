---
layout: post
title: "正确理解泊松分布"
category: technium
tags: [poisson]
latex: true
---


如果我们要向一个石器时代的人解释什么是电话，我们一定会说：“电话是一种机器，两个距离很远的人可以通过它进行交谈”，而不会说：“电话在 1876 年由贝尔发明，一台电话由以下几个部分构成……”——“泊松分布在 1876 年由泊松提出，泊松分布的公式是……”——所以我们要问的第一个问题是“泊松分布能拿来干嘛？”


泊松分布最常见的一个应用就是，它作为了排队论的一个输入。什么是排队论？比如我们去每天食堂打饭，最头疼的一个问题就是排队，之所以要排队是因为食堂打饭的大叔有限，假设学校有 1000 个学生，而食堂恰好配了 1000 个大叔和打饭的窗口，那么就永远不会有人排队。但是出于经营成本方面的考虑食堂通常不会这么干，因此如何控制窗口的数量并且保证学生不会因为排队时间太长而起义是一门很高深的学问。


在一段时间 t（比如 1 个小时）内来到食堂就餐的学生数量肯定不会是一个常数（比如一直是 200 人），而应该符合某种随机规律：比如在 1 个小时内来 200 个学生的概率是 10%，来 180 个学生的概率是 20%……一般认为，这种随机规律服从的就是泊松分布。


也就是在单位时间内有 k 个学生到达的概率为：


$$
P_{k}= \frac{ e^{-\lambda} {\lambda}^{k} } { k! }
$$


其中 $\lambda$ 为单位时间内学生的期望到达数。


### 二项分布


问题是“这个式子是怎么来的呢？”——我们知道泊松分布是二项分布满足某种条件的一个特殊形式，因此可以先从简单的二项分布入手，寻找两者之间的联系。


二项分布很容易理解，比如一个牛仔一枪打中靶子的概率是 p，如果我们让他开 10 枪，如果每击中一次目标就得 1 分，问他一共能得几分？虽然我们不能在牛仔射击前准确地预测出具体的得分 k，但可以求出 k 的概率分布，比如 k = 9 的概率是 50%，k = 8 分的概率是 30%……并且根据 k 的分布来判断他的枪法如何，这便是概率统计的思想。


具体计算的方法就是求出“得 k 分”的概率。比如“得 9 分”可以是“射失第 1 发，而命中其余的 9 发”，它的概率是 p 的 9 次方乘上 1 - p。


X O O O O O O O O O


O X O O O O O O O O


O O X O O O O O O O


......


根据组合数性质，在 ${9 \choose 10}$ 种情况下，牛仔都可以得到 9 分。因此牛仔“得 9 分”的概率 $P_k= {9 \choose 10} p^{9}$。


同理，“得 k 分”的概率就是 ${k \choose n} p^{k} (1-p)^{n-k}$。而对于一个神枪手（p = 1）来讲，他“得 10 分”的概率就是 1。


二项分布和泊松分布最大的不同是前者的研究对象是 n 个离散的事件（10 次射击），而后者考察的是一段连续的时间（单位时间）。因此泊松分布就是在二项分布的基础上化零为整。


### 化零为整

如果我们把单位时间划分成 n 个细小的时间片，假设在每个时间片内牛仔都在射击，只是这次他发射的不是子弹，而是学生——“命中目标”就代表向食堂成功地发射出一个学生，如果“没有命中”就表示学生被打到了食堂意外的其它地方。如果 n 不是无穷大，那么在某个时间片内可能出现两个学生同时进入食堂的状况，这样的话就和我们假设任意的时间片内之可能发生“有一个学生出现”或“没有学生出现”不符，为了能用二项分布去近似泊松分布，因此 n 必须趋向无穷，时间片必须无穷小，这也是为什么泊松分布的前提之一是“ n 很大”的原因！（另一个前提是“ p 很小”）


这样一来我们就可以用二项分布的公式表示单位时间到来 k 个学生的概率了。假设单位时间内发生 n 次独立的“发射学生”实验，把学生“发射”到食堂的概率是 p。


那么单位时间内食堂到来 k 个学生的概率为：

$$
P_k= {k \choose n} p^{k} {(1-p)}^{n-k}
$$


把组合数展开：

$$
P_k= \frac{n(n-1) \dots (n-k+1)}{k!}p^{k} (1-p)^{n-k}
$$


上下同乘 $(1-p)^{k}$：

$$
P_k= e\frac{n(n-1)\dots(n-k+1)}{k!}     \frac{ p^k (1-p)^n } {(1-p)^k}
$$



把 ${p}^{k}$ 拆成 k 个 p 连乘的形式放到左边分子上：

$$
P_k= \frac{np(np-p)\dots(np-kp+p)}{k!}    \frac{(1-p)^n}{(1-p)^{k}}
$$




调整 ${(1-p)^n}$：

$$
P_k= \frac{np(np-p)\dots(np-kp+p)}{k!}      \frac  {  {(1-p)^{-\frac{1}{p}} }^{-np}}   {(1-p)^{k}}
$$



因为 $p \to 0$ 时，有 ${(1-p)}^{-\frac{1}{p}} \to e$，得：


$$
P_k= \frac{np(np)\dots(np)}{k!}     \frac{e^{-np}}{1^k}
$$


令 $ np=\lambda$，就得到：


$$
P_k= \frac{\lambda^k}{k!}   {e}^{-\lambda}
$$



这就是我们熟悉的泊松公式，其中 $\lambda$ 的物理意义是单位时间内学生到来的数量，也就是平均到达率，是一个常数。
